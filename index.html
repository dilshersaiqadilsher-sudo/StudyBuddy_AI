<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>StudyBuddy AI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- PWA -->
<link rel="manifest" href="./manifest.json">
<meta name="description" content="StudyBuddy AI helps students with chat, math, study, games, stories, and Islamic learning.">
<meta name="application-name" content="StudyBuddy AI">
<meta name="theme-color" content="#0b1225">

<link rel="icon" href="./icon-192.png">
<link rel="apple-touch-icon" href="./icon-192.png">
<meta name="apple-mobile-web-app-capable" content="yes">

<style>
:root{
  --bg:#0b1225;
  --user:#2563eb;
  --bot:#1f2937;
  --text:#ffffff;
}
.light{
  --bg:#f3f4f6;
  --user:#2563eb;
  --bot:#e5e7eb;
  --text:#000000;
}
body{
  margin:0;
  background:var(--bg);
  color:var(--text);
  font-family:Arial,Helvetica,sans-serif;
  display:flex;
  justify-content:center;
}
.app{
  width:420px;
  max-width:100%;
  height:100vh;
  display:flex;
  flex-direction:column;
}
.top,.mode-bar{
  padding:8px;
  display:flex;
  gap:6px;
}
.top button,.mode-bar button{
  flex:1;
  padding:8px;
  border:none;
  border-radius:8px;
  cursor:pointer;
}
.chat{
  flex:1;
  overflow-y:auto;
  padding:10px;
}
.msg{
  margin:6px 0;
  padding:10px 14px;
  border-radius:14px;
  max-width:85%;
  white-space:pre-wrap;
}
.user{background:var(--user);align-self:flex-end;}
.bot{background:var(--bot);align-self:flex-start;}
.bottom{
  display:flex;
  gap:6px;
  padding:10px;
}
.bottom input{
  flex:1;
  padding:10px;
  border-radius:10px;
  border:none;
}
.bottom button{
  padding:10px 14px;
  border:none;
  border-radius:10px;
  background:#22c55e;
}
</style>
</head>

<body>
<div class="app">

<div class="top">
  <button onclick="toggleTheme()">ğŸŒ—</button>
  <button onclick="showInfo()">â„¹ï¸</button>
  <button onclick="exportChat()">â¬‡</button>
</div>

<div class="mode-bar">
  <button onclick="setMode('chat')">ğŸ’¬</button>
  <button onclick="setMode('math')">â—</button>
  <button onclick="setMode('study')">ğŸ“˜</button>
  <button onclick="setMode('islam')">ğŸ•Œ</button>
  <button onclick="setMode('games')">ğŸ®</button>
</div>

<div class="chat" id="chat"></div>

<div class="bottom">
  <input id="input" placeholder="Ask anything..." onkeydown="if(event.key==='Enter')send()">
  <button onclick="send()">â–¶</button>
</div>

</div>

<script>
let mode="chat";
let chatLog=[];
const chat=document.getElementById("chat");

function add(text,cls){
  const d=document.createElement("div");
  d.className="msg "+cls;
  d.innerText=text;
  chat.appendChild(d);
  chat.scrollTop=chat.scrollHeight;
}

function setMode(m){
  mode=m;
  add("Mode: "+m.toUpperCase(),"bot");
}

function send(){
  const i=document.getElementById("input");
  const t=i.value.trim();
  if(!t) return;
  i.value="";
  add(t,"user");

  if(mode==="math") solveMath(t);
  else if(mode==="study") study(t);
  else if(mode==="islam") islam(t);
  else if(mode==="games") games(t);
  else chatAI(t);
}

/* CHAT */
function chatAI(q){
  q=q.toLowerCase();
  if(q.includes("story")){
    add("ğŸ“– STORY:\nOnce there was a child who believed learning could change the world. That child built StudyBuddy AI and helped thousands ğŸŒâœ¨","bot");
  }
  else add("ğŸ¤– I am StudyBuddy AI â€” try Math, Games, Story, Quran, or Study!","bot");
}

/* MATH */
function solveMath(q){
  try{
    add("Answer: "+Function("return "+q)(),"bot");
  }catch{add("Math error","bot");}
}

/* STUDY */
function study(q){
  add("ğŸ“˜ Study Mode helps with Science, English, History & more.","bot");
}

/* ISLAM */
function islam(q){
  add("ğŸ•Œ Islamic Mode:\nType Quran, Surah Ikhlas, Surah Fatiha.","bot");
}

/* GAMES */
let secret=Math.floor(Math.random()*10)+1;
function games(q){
  if(q==="guess"){
    secret=Math.floor(Math.random()*10)+1;
    add("ğŸ¯ Guess number 1â€“10","bot");
  }
  else if(!isNaN(q)){
    add(Number(q)===secret?"ğŸ‰ Correct!":"âŒ Try again","bot");
  }
  else add("ğŸ® Type 'guess' or a number","bot");
}

/* INFO */
function showInfo(){
  add(
"â„¹ï¸ StudyBuddy AI\n\nâ€¢ Chat ğŸ¤–\nâ€¢ Math â—\nâ€¢ Study ğŸ“˜\nâ€¢ Islamic ğŸ•Œ\nâ€¢ Games ğŸ®\nâ€¢ Stories ğŸ“–\n\nBuilt by a young genius ğŸŒŸ",
"bot");
}

function toggleTheme(){document.body.classList.toggle("light");}
function exportChat(){
  const b=new Blob([chat.innerText],{type:"text/plain"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(b);
  a.download="chat.txt";
  a.click();
}

/* SERVICE WORKER */
if("serviceWorker"in navigator){
  navigator.serviceWorker.register("sw.js");
}

add("ğŸš€ Welcome to StudyBuddy AI!","bot");
</script>
</body>
</html>
