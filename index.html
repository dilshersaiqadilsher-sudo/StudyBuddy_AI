<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>StudyBuddy AI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link rel="manifest" href="./manifest.json">
<meta name="theme-color" content="#0b1225">
<link rel="icon" href="./icon-192.png">

<style>
:root{
  --bg:#0b1225;--card:#111a33;--user:#2563eb;
  --bot:#1f2937;--text:#ffffff;
}
.light{
  --bg:#f3f4f6;--card:#ffffff;
  --bot:#e5e7eb;--text:#000;
}
body{
  margin:0;background:var(--bg);color:var(--text);
  font-family:Arial;display:flex;justify-content:center;
}
.app{width:420px;max-width:100%;height:100vh;display:flex;flex-direction:column;}
.top,.mode-bar{display:flex;gap:6px;padding:8px;}
.top button,.mode-bar button{
  flex:1;border:none;border-radius:8px;
  padding:8px;cursor:pointer;
}
.chat{flex:1;overflow-y:auto;padding:10px;}
.msg{margin:6px 0;padding:10px;border-radius:14px;max-width:85%;}
.user{background:var(--user);align-self:flex-end;}
.bot{background:var(--bot);align-self:flex-start;}
.bottom{display:flex;gap:6px;padding:10px;}
.bottom input{flex:1;padding:10px;border-radius:10px;border:none;}
.bottom button{padding:10px;border:none;border-radius:10px;background:#22c55e;}
</style>
</head>

<body>
<div class="app">

<div class="top">
  <button onclick="toggleTheme()">ğŸŒ— Theme</button>
  <button onclick="showInfo()">â„¹ï¸ Info</button>
  <button onclick="exportChat()">â¬‡ Export</button>
</div>

<div class="mode-bar">
  <button onclick="setMode('chat')">ğŸ’¬ Chat</button>
  <button onclick="setMode('math')">â— Math</button>
  <button onclick="setMode('study')">ğŸ“˜ Study</button>
  <button onclick="setMode('islam')">ğŸ•Œ Islamic</button>
  <button onclick="setMode('games')">ğŸ® Games</button>
</div>

<div class="chat" id="chat"></div>

<div class="bottom">
  <input id="input" placeholder="Ask something..." onkeydown="if(event.key==='Enter')send()">
  <button onclick="send()">â–¶</button>
</div>

</div>

<script>
let mode="chat";
let chatLog=[];
let secretNumber=Math.floor(Math.random()*10)+1;
const chat=document.getElementById("chat");

function add(t,c){
  const d=document.createElement("div");
  d.className="msg "+c;d.innerText=t;
  chat.appendChild(d);chat.scrollTop=chat.scrollHeight;
  chatLog.push((c==="user"?"User: ":"AI: ")+t);
}

function setMode(m){
  mode=m;
  add("Mode: "+m.toUpperCase(),"bot");
  if(m==="games") add("ğŸ® Type: 'number game' or 'quiz'","bot");
}

function send(){
  const i=input;const t=i.value.trim();
  if(!t)return;i.value="";add(t,"user");

  if(mode==="math") math(t);
  else if(mode==="study") study(t);
  else if(mode==="islam") islam(t);
  else if(mode==="games") games(t);
  else chatAI(t);
}

/* CHAT */
function chatAI(q){
  q=q.toLowerCase();
  if(q.includes("story")) story(q);
  else add("Tell me more ğŸ˜Š","bot");
}

/* STORY */
function story(q){
  add("ğŸ“– Once upon a time, there was a young learner who never gave up. Even when problems came, he trusted Allah and kept learning. Because of patience and hard work, he became successful and helped others. ğŸŒŸ","bot");
}

/* GAMES */
function games(q){
  if(q.includes("number")){
    add("Guess a number between 1 and 10","bot");
  }else if(!isNaN(q)){
    if(Number(q)===secretNumber){
      add("ğŸ‰ Correct! You win!","bot");
      secretNumber=Math.floor(Math.random()*10)+1;
    }else add("âŒ Try again","bot");
  }else if(q.includes("quiz")){
    add("Quiz: What is 5 + 3 ?","bot");
  }else if(q==="8"){
    add("âœ… Correct!","bot");
  }else add("ğŸ® Type 'number game' or 'quiz'","bot");
}

/* STUDY */
function study(q){
  add("ğŸ“˜ Study help coming soon for: "+q,"bot");
}

/* ISLAM */
function islam(q){
  add("ğŸ•Œ Allah is One. He loves patience and knowledge ğŸ¤","bot");
}

/* MATH */
function math(q){
  try{add("Answer: "+Function("return "+q)(),"bot");}
  catch{add("Math error","bot");}
}

/* INFO */
function showInfo(){
  add("â„¹ï¸ StudyBuddy AI can:\nâ€¢ Chat\nâ€¢ Solve Math\nâ€¢ Teach Subjects\nâ€¢ Islamic Learning\nâ€¢ Play Games\nâ€¢ Tell Stories","bot");
}

function toggleTheme(){document.body.classList.toggle("light");}
function exportChat(){
  const b=new Blob([chatLog.join("\n")],{type:"text/plain"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(b);a.download="chat.txt";a.click();
}

if("serviceWorker"in navigator){
  navigator.serviceWorker.register("sw.js");
}

add("Welcome to StudyBuddy AI ğŸš€","bot");
</script>
</body>
</html>
