<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ultra Smart AI Friend ‚ö° Ultimate</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --bg:#050b1a;
  --card:#0b1225;
  --user:#2563eb;
  --bot:#1e293b;
  --text:#e5e7eb;
}
.light{
  --bg:#f5f7fb;
  --card:#ffffff;
  --user:#2563eb;
  --bot:#e5e7eb;
  --text:#000;
}
*{box-sizing:border-box;font-family:system-ui}
body{
  margin:0;
  background:var(--bg);
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  color:var(--text);
}
.app{
  width:380px;
  height:650px;
  background:var(--card);
  border-radius:18px;
  display:flex;
  flex-direction:column;
  overflow:hidden;
}
.header{
  background:linear-gradient(90deg,#2563eb,#38bdf8);
  color:#fff;
  padding:12px;
  text-align:center;
}
.chat{
  flex:1;
  padding:12px;
  overflow-y:auto;
}
.msg{
  max-width:85%;
  padding:10px 14px;
  border-radius:14px;
  margin-bottom:10px;
  font-size:14px;
  white-space:pre-wrap;
}
.user{background:var(--user);color:#fff;margin-left:auto}
.bot{background:var(--bot)}
.controls{
  display:flex;
  gap:6px;
  padding:6px;
  justify-content:center;
}
.controls button{
  font-size:11px;
  padding:4px 6px;
}
.inputBar{
  display:flex;
  gap:6px;
  padding:10px;
}
input{
  flex:1;
  padding:10px;
  border-radius:12px;
  border:none;
}
button{
  border:none;
  border-radius:12px;
  padding:0 12px;
  background:#22c55e;
  color:#fff;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="app" id="app">
  <div class="header">
    <b>Ultra Smart AI Friend ‚ö° Ultimate</b><br>
    <small id="date"></small>
  </div>

  <div class="chat" id="chat"></div>

  <div class="controls">
    <button onclick="toggleTheme()">THEME</button>
    <button onclick="exportChat()">EXPORT</button>
    <button onclick="login()">LOGIN</button>
  </div>

  <div class="inputBar">
    <input id="input" placeholder="Math, Science, English..." />
    <button onclick="send()">‚ñ∂</button>
  </div>
</div>

<script>
/* ================= BASIC ================= */
const chat=document.getElementById("chat");
const input=document.getElementById("input");
document.getElementById("date").textContent=new Date().toDateString();

/* ================= LOGIN ================= */
let user=localStorage.getItem("user");
function login(){
  const name=prompt("Enter username");
  if(name){
    user=name;
    localStorage.setItem("user",name);
    addMsg("Logged in as "+name,"bot");
  }
}

/* ================= THEME ================= */
function toggleTheme(){
  document.body.classList.toggle("light");
}

/* ================= CHAT ================= */
function addMsg(text,role){
  const d=document.createElement("div");
  d.className="msg "+role;
  d.textContent=text;
  chat.appendChild(d);
  chat.scrollTop=chat.scrollHeight;
}

/* ================= EXPORT ================= */
function exportChat(){
  let txt=[...document.querySelectorAll(".msg")]
    .map(m=>m.textContent).join("\n\n");
  const blob=new Blob([txt],{type:"text/plain"});
  const a=document.createElement("a");
  a.href=URL.createObjectURL(blob);
  a.download="chat.txt";
  a.click();
}

/* ================= MATH FIX (IMPORTANT) ================= */
function isMath(text){
  return /^[0-9+\-*/().^%= ]+$/.test(text);
}

function solveMath(text){
  text=text.replace("=","");
  text=text.replace(/\^/g,"**");
  try{
    const result=Function(`return (${text})`)();
    return `üßÆ ${text} = ${result}`;
  }catch{
    return "‚ùå Invalid math";
  }
}

/* ================= OFFLINE AI ================= */
const offline={
  hi:"Hello üëã How can I help?",
  science:"Science studies nature and experiments.",
  history:"History studies past events.",
  english:"English is a global language."
};

/* ================= SEND ================= */
function send(){
  const text=input.value.trim();
  if(!text) return;
  addMsg(text,"user");
  input.value="";

  /* MATH (FIXED) */
  if(isMath(text)){
    addMsg(solveMath(text),"bot");
    return;
  }

  /* OFFLINE AI */
  const key=text.toLowerCase();
  if(offline[key]){
    addMsg(offline[key],"bot");
    return;
  }

  /* MULTI-AI PLACEHOLDER */
  addMsg("ü§ñ Online AI not connected yet.","bot");
}

/* INIT */
addMsg("Hello. I can solve unlimited math correctly now.","bot");
</script>

</body>
</html>
